<Window x:Class="StartupMaster.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:converters="clr-namespace:StartupMaster.Converters"
        ui:WindowHelper.UseModernWindowStyle="True"
        Title="Startup Master - Ultimate Windows Startup Manager" 
        Height="750" Width="1400"
        WindowStartupLocation="CenterScreen"
        Icon="app.ico">
    
    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>
        
        <Style x:Key="IconButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="FontSize" Value="16"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <TextBlock Text="ðŸš€ Startup Master" FontSize="28" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBlock Text="Complete control over everything that runs at Windows startup" 
                       FontSize="14" Opacity="0.7"/>
        </StackPanel>

        <!-- Toolbar -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
            <Button Name="RefreshButton" Content="ðŸ”„ Refresh" Click="RefreshButton_Click" 
                    Padding="15,8" FontSize="14" Margin="0,0,10,0" ToolTip="Refresh (F5)"/>
            <Button Name="AddButton" Content="âž• Add New" Click="AddButton_Click" 
                    Padding="15,8" FontSize="14" Margin="0,0,10,0" ToolTip="Add (Ctrl+N)"/>
            <Button Name="ExportButton" Content="ðŸ’¾ Export" Click="ExportButton_Click" 
                    Padding="15,8" FontSize="14" Margin="0,0,10,0" ToolTip="Export (Ctrl+E)"/>
            <Button Name="ImportButton" Content="ðŸ“‚ Import" Click="ImportButton_Click" 
                    Padding="15,8" FontSize="14" Margin="0,0,10,0" ToolTip="Import (Ctrl+I)"/>
            
            <Separator Width="1" Margin="10,0"/>
            
            <Button Name="StatisticsButton" Content="ðŸ“Š Statistics" Click="StatisticsButton_Click" 
                    Padding="15,8" FontSize="14" Margin="0,0,10,0" ToolTip="View Statistics (Ctrl+T)"/>
            <Button Name="BatchButton" Content="âš¡ Batch" Click="BatchButton_Click" 
                    Padding="15,8" FontSize="14" Margin="0,0,10,0" ToolTip="Batch Operations (Ctrl+B)"/>
            
            <Separator Width="1" Margin="10,0"/>
            
            <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="10,0,5,0"/>
            <ComboBox Name="FilterComboBox" Width="150" SelectionChanged="FilterComboBox_SelectionChanged">
                <ComboBoxItem Content="All Items" IsSelected="True"/>
                <ComboBoxItem Content="Enabled Only"/>
                <ComboBoxItem Content="Disabled Only"/>
                <ComboBoxItem Content="High Impact"/>
                <ComboBoxItem Content="Registry"/>
                <ComboBoxItem Content="Startup Folder"/>
                <ComboBoxItem Content="Task Scheduler"/>
                <ComboBoxItem Content="Services"/>
            </ComboBox>

            <TextBox Name="SearchBox" Width="200" Margin="10,0,0,0" 
                     ui:ControlHelper.PlaceholderText="Search (Ctrl+F)..." 
                     TextChanged="SearchBox_TextChanged"/>
        </StackPanel>

        <!-- Main DataGrid -->
        <DataGrid Grid.Row="2" Name="StartupItemsGrid" 
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  RowHeight="45"
                  AlternatingRowBackground="#0A000000">
            
            <DataGrid.Columns>
                <DataGridTextColumn Header="Status" Binding="{Binding StatusDisplay}" Width="100" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="250" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Command" Binding="{Binding Command}" Width="*" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="ToolTip" Value="{Binding Command}"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Location" Binding="{Binding LocationDisplay}" Width="130" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Boot Impact" Binding="{Binding ImpactDisplay}" Width="90" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Foreground" Value="#FFD700"/>
                            <Setter Property="ToolTip" Value="Estimated seconds saved if disabled"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Delay (sec)" Binding="{Binding DelaySeconds}" Width="80">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTemplateColumn Header="Actions" Width="200">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Content="âœ“" Style="{StaticResource IconButtonStyle}" 
                                        Click="EnableButton_Click" ToolTip="Enable"
                                        Visibility="{Binding IsEnabled, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <Button Content="âœ—" Style="{StaticResource IconButtonStyle}" 
                                        Click="DisableButton_Click" ToolTip="Disable"
                                        Visibility="{Binding IsEnabled, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                                <Button Content="âœï¸" Style="{StaticResource IconButtonStyle}" 
                                        Click="EditButton_Click" ToolTip="Edit"/>
                                <Button Content="ðŸ—‘ï¸" Style="{StaticResource IconButtonStyle}" 
                                        Click="DeleteButton_Click" ToolTip="Remove"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3" Margin="0,10,0,0">
            <StatusBarItem>
                <TextBlock Name="StatusText" Text="Ready"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Name="ItemCountText" Text="0 items"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
